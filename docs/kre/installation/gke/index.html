<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.74.3"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/website/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/website/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/website/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/website/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/website/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/website/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/website/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/website/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/website/favicons/android-192x192.png sizes=192x192><title>GKE | Konstellation</title><meta property="og:title" content="GKE"><meta property="og:description" content="Required configuration to installing KRE on GKE."><meta property="og:type" content="article"><meta property="og:url" content="https://konstellation-io.github.io/website/docs/kre/installation/gke/"><meta property="article:modified_time" content="2020-08-14T13:39:16+02:00"><meta property="og:site_name" content="Konstellation"><meta itemprop=name content="GKE"><meta itemprop=description content="Required configuration to installing KRE on GKE."><meta itemprop=dateModified content="2020-08-14T13:39:16+02:00"><meta itemprop=wordCount content="430"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="GKE"><meta name=twitter:description content="Required configuration to installing KRE on GKE."><link rel=preload href=/website/scss/main.min.33e67b67522abab078f32f1ef9432f9311c52c0a0aed6a9c7f75fedcb53af9be.css as=style><link href=/website/scss/main.min.33e67b67522abab078f32f1ef9432f9311c52c0a0aed6a9c7f75fedcb53af9be.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/website/><span class=navbar-logo><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="30" height="30" viewBox="0 0 30 30" id="svg9" sodipodi:docname="logo.svg" inkscape:version="0.92.5 (2060ec1f9f, 2020-04-08)"><defs id="defs13"/><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="1602" inkscape:window-height="871" id="namedview11" showgrid="false" inkscape:zoom="19.666667" inkscape:cx="25.549767" inkscape:cy="15.135206" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="0" inkscape:current-layer="svg9"/><title id="title2">4135B303-CB0F-43C8-8C8F-225E46D3A3E3</title><g id="DS-Style-Guide" style="fill:none;fill-rule:evenodd;stroke:none;stroke-width:1" transform="matrix(0.41143082,0,0,0.41706694,-4.8865756,-5.012913)"><g id="DS-/-Style-Guide-/-Brand" transform="translate(-1323,-629)" style="fill:#e3e3e3"><g id="Atoms-/-Brand-/-Isotype-/-isotype-B-light" transform="translate(1323,629)"><g id="Atoms-/-Brand-/-Isotype-v4" transform="translate(17.361702,18.382979)"><path d="M39.392034.33851303C52.047353 4.0838212 61.27663 15.737809 61.27663 29.538647c0 16.82579-13.717447 30.466173-30.638298 30.466173C13.71714 60.00482 3.4042553e-5 46.364437 3.4042553e-5 29.538647 3.4042553e-5 15.737809 9.2293106 4.0838212 21.884289.33851303v0V9.5893971C14.155609 12.947446 8.7537362 20.615105 8.7537362 29.538647c0 12.018567 9.7981278 21.76131 21.8845958 21.76131 12.086468.0 21.884255-9.742743 21.884255-21.76131.0-8.923542-5.401532-16.591201-13.130553-19.9492499v0zM30.638332 20.833852c4.834383.0 8.753702 3.897301 8.753702 8.704863.0 4.807223-3.919319 8.704524-8.753702 8.704524-4.834724.0-8.754043-3.897301-8.754043-8.704524.0-4.807562 3.919319-8.704863 8.754043-8.704863z" id="Combined-Shape" inkscape:connector-curvature="0"/></g></g></g></g></svg></span><span class="text-uppercase font-weight-bold">Konstellation</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/website/docs/><span class=active>Documentation</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/website/docs/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Documentation</a></li><ul><li class="collapse show" id=websitedocs><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/website/docs/overview/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Overview</a></li><ul><li class=collapse id=websitedocsoverview></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/website/docs/kdl/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Development Lab (KDL)</a></li><ul><li class=collapse id=websitedocskdl></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/website/docs/krt/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Runtime Transport (KRT)</a></li><ul><li class=collapse id=websitedocskrt><a class="td-sidebar-link td-sidebar-link__page" id=m-websitedocskrtconcepts href=/website/docs/krt/concepts/>Concepts</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-websitedocskrtspecs href=/website/docs/krt/specs/>KRT YAML specs</a><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/website/docs/krt/tasks/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Tasks</a></li><ul><li class=collapse id=websitedocskrttasks><a class="td-sidebar-link td-sidebar-link__page" id=m-websitedocskrttasksdefine_krt_yml href=/website/docs/krt/tasks/define_krt_yml/>Define a krt.yml file</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-websitedocskrttaskscreate_an_entrypoint href=/website/docs/krt/tasks/create_an_entrypoint/>Create an Entrypoint</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-websitedocskrttaskscoding_a_node href=/website/docs/krt/tasks/coding_a_node/>Coding a node</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-websitedocskrttaskscreate_krt_file href=/website/docs/krt/tasks/create_krt_file/>Create a KRT</a></li></ul></ul></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/website/docs/kre/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Runtime Engine (KRE)</a></li><ul><li class="collapse show" id=websitedocskre><a class="td-sidebar-link td-sidebar-link__page" id=m-websitedocskreconcepts href=/website/docs/kre/concepts/>Concepts</a><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/website/docs/kre/installation/ class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Installation</a></li><ul><li class="collapse show" id=websitedocskreinstallation><a class="td-sidebar-link td-sidebar-link__page" id=m-websitedocskreinstallationhelm href=/website/docs/kre/installation/helm/>Helm basics</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-websitedocskreinstallationminikube href=/website/docs/kre/installation/minikube/>Minikube</a>
<a class="td-sidebar-link td-sidebar-link__page active" id=m-websitedocskreinstallationgke href=/website/docs/kre/installation/gke/>GKE</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-websitedocskreinstallationeks href=/website/docs/kre/installation/eks/>EKS</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-websitedocskreinstallationvalidate href=/website/docs/kre/installation/validate/>Validate</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-websitedocskreinstallationcustomization href=/website/docs/kre/installation/customization/>Customization</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/website/docs/kre/tasks/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Tasks</a></li><ul><li class=collapse id=websitedocskretasks><a class="td-sidebar-link td-sidebar-link__page" id=m-websitedocskretaskslogin href=/website/docs/kre/tasks/login/>Login</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-websitedocskretaskscreate_runtime href=/website/docs/kre/tasks/create_runtime/>Create runtime</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-websitedocskretaskscreate_version href=/website/docs/kre/tasks/create_version/>Create version</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-websitedocskretasksversion_management href=/website/docs/kre/tasks/version_management/>Version Management</a></li></ul></ul></li></ul></ul></li></ul></ul></nav></div></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/konstellation-io/website/edit/master/content/en/docs/KRE/installation/gke/index.md target=_blank><i class="fa fa-edit fa-fw"></i>Edit this page</a>
<a href="https://github.com/konstellation-io/website/issues/new?title=GKE" target=_blank><i class="fab fa-github fa-fw"></i>Create documentation issue</a></div><nav id=TableOfContents><ul><li><a href=#ingress-controller>Ingress controller</a></li><li><a href=#cert-manager>Cert manager</a></li><li><a href=#storage-provisioner>Storage provisioner</a></li></ul><ul><li><a href=#get-ingress-controller-hostname>Get Ingress Controller hostname</a></li><li><a href=#create-wildcard-entry-in-your-hosted-zone>Create wildcard entry in your hosted zone</a></li><li><a href=#validate>Validate</a></li></ul><ul><li><a href=#create-valuesyaml>Create values.yaml</a></li><li><a href=#install-helm-chart>Install Helm chart</a></li><li><a href=#validate-the-installation>Validate the installation</a></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=https://konstellation-io.github.io/website/docs/>Documentation</a></li><li class=breadcrumb-item><a href=https://konstellation-io.github.io/website/docs/kre/>Runtime Engine (KRE)</a></li><li class=breadcrumb-item><a href=https://konstellation-io.github.io/website/docs/kre/installation/>Installation</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://konstellation-io.github.io/website/docs/kre/installation/gke/>GKE</a></li></ol></nav><div class=td-content><h1>GKE</h1><div class=lead>Required configuration to installing KRE on GKE.</div><h1 id=gke-deployment>GKE deployment</h1><p>The flavor of Kubernetes on Google is called GKE (Google Kubernetes Engine) which allow to deploy a cluster managed by Google. This means that Goolge will manage the lifecyle of the Master nodes of our cluster.</p><p>When you create a GKE cluster by default is created an Instance Group, which is resposible to start the GCE (Goolge Compute Engine) instances and scale up and down depending of your configuration. In these instances of GCE is where the loads that we deploy on GKE will run. Therefore is needed to ajust the type of instances on this instance group, to support the load of your deployment. For a PoC of KRE you can setup an Instance Group with min instances 1 up to 3 of type <code>n1-standard-2</code> and everything will works fine. Be aware about the autoscaling configuration of the Instances Group, because if you only have one Instance Group added to your GKE cluster, at least is required one instance up in order to run some Kubernetes componentes that run as PODS.</p><p>Deploy an GKE cluster is not the goal of this guide, only the detail some specific configuration needed to run KRE on top of it. It is recommend to use IaC (Infrastructure As Code) approach using Terraform to automate the creation of your cluster, <a href=https://learn.hashicorp.com/tutorials/terraform/gke>here</a> you can find usefull resources about that. Also you can follow the instructions from the official <a href=https://cloud.google.com/cloud-build/docs/deploying-builds/deploy-gke>Google site</a>.</p><h1 id=storage>Storage</h1><h1 id=kubernetes-required-components>Kubernetes required components</h1><h2 id=ingress-controller>Ingress controller</h2><h2 id=cert-manager>Cert manager</h2><h2 id=storage-provisioner>Storage provisioner</h2><h1 id=dns>DNS</h1><h2 id=get-ingress-controller-hostname>Get Ingress Controller hostname</h2><p>First of all you need to konw the name of the ELB where we have to point our DNS entry. With the below command you will get name of this Load Balancer.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl -n kube-system get svc -l <span style=color:#000>app</span><span style=color:#ce5c00;font-weight:700>=</span>nginx-ingress,component<span style=color:#ce5c00;font-weight:700>=</span>controller -o <span style=color:#000>jsonpath</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;{.items[0].status.loadBalancer.ingress[0].hostname}&#34;</span>
</code></pre></div><p>The output of this command should be something like <code>-</code>.</p><h2 id=create-wildcard-entry-in-your-hosted-zone>Create wildcard entry in your hosted zone</h2><h2 id=validate>Validate</h2><p>To validate that the DNS configuration is working fine you can use the tool <code>dig</code> to query the DNS as follow.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>dig admin.kre.yourdamin.com
</code></pre></div><p>The output should be something as below.</p><pre><code>; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; admin.kre.yourdamin.com
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 901
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 65494
;; QUESTION SECTION:
;admin.kre.yourdamin.com.	IN	A

;; ANSWER SECTION:
admin.kre.yourdamin.com.	1799 IN	A	1.2.3.4

;; Query time: 64 msec
;; SERVER: 127.0.0.53#53(127.0.0.53)
;; WHEN: mié ago 12 16:18:49 CEST 2020
;; MSG SIZE  rcvd: 75

</code></pre><h1 id=helm-deployment>Helm deployment</h1><h2 id=create-valuesyaml>Create values.yaml</h2><h2 id=install-helm-chart>Install Helm chart</h2><h2 id=validate-the-installation>Validate the installation</h2><div class="text-muted mt-5 pt-3 border-top">Last modified August 14, 2020: <a href=https://github.com/konstellation-io/website/commit/20009b47e040d120821481cb508ff8810e06f57b>start gke installation (20009b4)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank href=https://github.com/konstellation-io/kre><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2020 The Konstellation Authors All Rights Reserved</small></div></div></div></footer></div><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script><script src=/website/js/main.min.b9195968a6c6ab09d066a0265a4d18503656ea780803ae5bf4ae83f9edc7b937.js integrity="sha256-uRlZaKbGqwnQZqAmWk0YUDZW6ngIA65b9K6D+e3HuTc=" crossorigin=anonymous></script></body></html>